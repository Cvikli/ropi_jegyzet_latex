\newpage
\section{Totálisan unimoduláris mátrixok és alkalmazásai}

Egy totálisan unimoduláris mátrixn minden négyzetes részmátrixának determinánsa
$0, 1$ vagy $-1$. Ehhez szükséges (de nem elégséges) feltétel, hogy a mátrix
elemei is csak $0, 1$ vagy $-1$ lehetnek.

\[
\begin{rcases}
A \text{ totálisan unimoduláris -- TU} \\
b \text{ egész vektor} \\
c \text{ tetszőleges} \in \mathbb{R}^n \\
\text{max} \left\{ cx:Ax \leq b \right\} \text{ LP feladat}\\
\text{ami megoldható és véges}
\end{rcases} \Rightarrow \parbox[t]{8cm}{ Az IP feladat is megoldható és
maximuma megegyezik az IP feladat maximumával.}
\]

\emph{Lemma:} a totálisan unimoduláris tulajdonság megmarad, ha:

\begin{description}
  \item[sor vagy oszlopot $\cdot (-1)$] $\Rightarrow$ ekkor a determináns
  előjele változik meg.
  \item[egységvektor sor vagy oszlopként való hozzáadása] $\Rightarrow$ ha a
  mátrixhoz egységvektort veszünk hozzá például oszlopként, és egy kiválasztott
  négyzetes részmátrixában ez az oszlop szerepel, akkor az új oszlop szerinti
  kifejtésből azonnal látszik, hogy a determináns megegyezik az eredeti mátrix
  egy négyzetes részmátrixának determinánsával vagy annak ellentettjével, így
  értéke $0, 1$ vagy $-1$.
  \item[sor vagy oszlop ismétlés] $\Rightarrow$ ha a kiválasztott részmátrixba
  az eredeti is szerepel a determináns nulla lesz, ha csak az egyik marad, akkor
  előáll az eredeti mátrixból képzett részmátrix, amely determinánsának értéke
  megmarad $0, 1$ vagy $-1$. 
  \item[transzponáljuk] $\Rightarrow$ megmarad a determináns definiciójának
  következményeként.
\end{description}

\emph{Tétel. Bármely irányitott gráf illekszkedés mátrixa~\footnote{$ 
B(G_{(V,E)})=
b_{i_{\in V}j_{\in E}}=
\begin{cases}
0  & \text{ha a } j \text{--edik él nem illleszkedik az } i \text{--edik ponthoz,} \\
+1  & \text{ha a } j \text{--edik élnek az } i \text{--edik pont kezdőpontja,} \\
-1  & \text{ha a } j \text{--edik élnek az } i \text{--edik pont a végpontja,} \\
+1  & \text{ha a } j \text{--edik él az } i \text{--edik ponthoz illeszkedő hurokél.} \\
\end{cases}$} totálisan unimoduláris.}.\\

Irányitott illeszkedési mátrixnál az oszlopban $1$ van amely pontból indul az
él, $-1$ ahove mutat; hurokél esetébben egyetlen $1$--es található. A
bizonyitást teljes indukcióval. Legyen $M \in \mathbb{M}_{k\times k}$ méretű
részmátrix. Ha $k=1$ az állitás nyilvánvaló. Ha $k \geq 2$ és létezzik egy darab
oszlop amelybe legfeljebb egy nem nulla elem van, akkor kifejtés aszerint és az
indukció adja a többit. Másképp minden oszlopábban egy darab $+1$ és egy darab
$-1$ van. Így $M$ sorainak összege nullvektor $\Rightarrow$ det$M=0$.\\

\emph{Tétel. Páros gráf~\footnote{Páros gráfnak nevezünk egy $G$ gráfot, ha
csúcsainak halmazát fel tudjuk úgy osztani egy $A$ és $B$ halmazra, hogy az
összes $G$-beli élre teljesül, hogy az egyik végpontja $A$-ban van, a másik
pedig $B$-ben.} illeszkedési mátrixa totálisan unimoduláris.}\\ 

Mutason minden él $A$--ból $B$--be. Irányított gráf illeszkedési mátrixe TU. Az
eredeti illeszkedési mátriszának megkapásához $B$ csúcsainak megfelelő sorokat
$-1$--el szorozzuk.

\subsection{Maximális összsulyú párositás IP feladatként}

Legyen $x$ indikátor, hogy az él benne van e párositásban, $w$ egy tetszőleges
él súlyfüggvény és $B$ az illeszkedési mátrix (amely páros gráf lévén totálisan
unimoduláris). A \emph{feladat}, megfogalmazható mint max$\left\{ wx:Bx <= (1,
\cdots, 1)^T, x \geq 0 \right\}$. Az $x \geq 0 $ feltételt bevisszük $B$
mátrixba kiegészitve azt egy $m \times m$--es egységmátrix ellentettjével, de ez
nem változtat TU tulajdonságon. 

Az egyenlőtlenség így azt fejezi ki, hogy egy csucsból legfeljebb egy kiinduló
élet választunk ki, ami adja a párositás feladatát. 

\[
\begin{rcases}
B'=\begin{bmatrix} B \\ -I \end{bmatrix} \text{ TU} \\
b \text{ egész}
\end{rcases} \Rightarrow x \text{ egész vektor ($0$ vagy $1$) értékű -- IP feladat}
\]

A max$\left\{ wx : Bx \leq (1,\cdots,1)^T, x \geq 0 \right\}$ duálisa
min$\{ y(1,\cdots,1)^T : yB \geq w,$ $y~\geq~0\}$. Az $y$ megoldás
minden $v$ csúcshoz $c(v)$ címkét rendel, ahogy Egerváry Jenő párositás
algoritmusa is:

\[ yB \geq w \Rightarrow c(a) + c(b) \geq w(e), \forall e=\{a,b\}\in E.\]

\subsection{Intervallumgráf}

A számegyenes véges sok intervallum alkossa egy gráf csúcshalmazát, és két csúcs
akkor legyen szomszédos, ha a megfelelő intervallumok metszők; az így
meghatározott gráf az intervallumgráf. Felthető, hogy a gráfot meghatározó
intervallumok $n$--re az $[1,n]$ egész végpontú, zárt részintervallumai.

Legyen az $I=\left\{I_1, I_2, \cdots, I_n\right\}$ intervallumrendszer.
Rendeljük ehhez $n \times m$--es $A(I)$ mátrixot: sorai feleljenek meg az
$1,2,\cdots,n$ egészeknek, oszlopai peddig az I intervallumainak. Az $i$--ik sor
és a $j$--ik oszlop kereszteződésben akkor álljon $1$--es, ha $i \in I_j$, és
minden más helyen álljon $0$. \\

\emph{Tétel. Az így definiált A(I) mátrix totálisan unimoduláris.} \\

A bizonyitáshoz kiválasztunk egy tetszőleges $k \times k$ részmátrixot, majd
teljes indukciót használunk az egyesek darabszáma szerint. Ha nulla darab
egyesből áll a mátrix az nyilván TU. Ha ven benne két oszlop amelyben az első
egyes azonos helyen áll, akkor a nagyobb egyes darabszámúból kivonjuk a kisedd
darabszámot. Ez az egyesek darabszámát csökkenti, de a detereminását nem
változtatja.

Ha nincs ilyen szolop, de van csupa null oszlop, akkor a determináns nulla. Ha
egyik sem teljesül, akkor pedig be tudjuk rendezni az oszlopkat úgy, hogy az
alsó háromszögmátrixot kapunk oszlop cserével. Ez a művelet a determinánst csak
előjelbe változtatja meg, így a determináns egy vagy minusz egy marad. \\

\emph{Tétel. Az intervallumgráfok tetszőleges k színre megszinezhetőek
egyenletesen.}\\ 

Az egyenletesen alatt azt értjük, hogy ha $i$--t tartalmazó intervallumok száma
$d_i$, akkor ezek közül minden felhasznált szín esetén az ilyen szinű
intervallumok száma $\lceil \frac{d_i}{k} \rceil$~\footnote{felső egészrész}
vagy $\lfloor \frac{d_i}{k} \rfloor$~\footnote{alsó egészrész}.

Elég bebizonyitani, hogy az intervallumok közül kiválasztható néhány úgy, hogy
az intervallum közül kiválasztható néhány úgy, hogy bármely $1 \leq i \leq n$
esetén az $i$--t tartalmazó intervallumgráfok között $\lceil \frac{d_i}{k}
\rceil$ vagy $\lfloor \frac{d_i}{k} \rfloor$ darab kiválasztott legyen. Ekkor a
kiválasztott intervallumokat megszínezzük egy szsínnel majd elhagyuk őket, a
megmaradt intervalumra meg ugyanaz $k-1$--el.

Legyen:
\[\begin{rcases}
A=A(I) \\
d = n \text{ dimenziós vektor } i \text{--ik komponense } d_i \\
\lceil \frac{d}{k} \rceil \text{ vektor } i \text{--ik komponense} \lceil \frac{d_i}{k} \rceil \\
\lfloor \frac{d}{k} \rfloor \text{ vektor } i \text{--ik komponense} \lfloor \frac{d_i}{k} \rfloor \\
\lfloor \frac{d}{k} \rfloor \leq Ax \leq \lceil \frac{d}{k} \rceil, 0 \leq x \leq (1,\cdots, 1)^T
\end{rcases} \parbox[t]{6cm}{Megoldás: $x=\left( \frac{1}{k}, \cdots, \frac{1}{k} \right)^T$ ahol $A$
TU $\Rightarrow \exists$ egészértékű megoldás.} 
\]

$x$--ben $0$ és $1$ közötti elemek vannak, és egy komponense oszlop öszegge
$\lceil \frac{d}{k} \rceil$ és $ \lfloor \frac{d}{k} \rfloor$ között van. Így
ezeknap az oszlopoknak megfelelő intervalumukat kiválasztva valóbban $\lceil
\frac{d_i}{k} \rceil$ vagy $ \lfloor \frac{d_i}{k} \rfloor$ illeszkedi $i$--re.